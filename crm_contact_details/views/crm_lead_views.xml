<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="crm_lead_view_form_inherit" model="ir.ui.view">
        <field name="name">crm.lead.view.form.inherit</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"></field>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='lead']" position="after">
                <page name="details" string="Contact details" invisible="type == 'lead'">
                    <!-- Address Details Section -->
                    <group>
                        <field name="address_detail_ids"
                               string="Address Details"
                               readonly="partner_id == False"
                               context="{'default_parent_id': partner_id, 'default_company_type': 'company', 'default_type': 'delivery', 'default_lead_id': id}"
                               force_save="1">
                            <list editable="bottom">
                                <field name="is_selected" widget="boolean" nolabel="1" force_save="1"/>
                                <field name="name" readonly="1"/>
                                <field name="phone" readonly="1"/>
                                <field name="mobile" readonly="1"/>
                                <field name="email" readonly="1"/>
                                <field name="user_id" readonly="1"/>
                                <field name="street" readonly="1"/>
                                <field name="city" readonly="1"/>
                                <field name="state_id" readonly="1"/>
                                <field name="country_id" readonly="1"/>
                                <field name="company_id" readonly="1"/>
                            </list>
                            <form>
                                <sheet>
                                    <group>
                                        <group>
                                            <field name="name" string="Contact Name" placeholder="e.g. New Address"/>
                                            <label for="street" string="Address"/>
                                            <div class="o_address_format" name="div_address">
                                                <field name="street" placeholder="Street..." class="o_address_street"/>
                                                <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                                                <field name="city" placeholder="City" class="o_address_city"/>
                                                <field name="state_id" class="o_address_state" placeholder="State" options="{'no_open': True, 'no_quick_create': True}" context="{'country_id': country_id, 'default_country_id': country_id, 'zip': zip}"/>
                                                <field name="zip" placeholder="ZIP" class="o_address_zip"/>
                                                <field name="country_id" placeholder="Country" class="o_address_country" options='{"no_open": True, "no_create": True}'/>
                                            </div>
                                        </group>
                                        <group>
                                            <field name="email" widget="email"/>
                                            <field name="phone" widget="phone"/>
                                            <field name="mobile" widget="phone"/>
                                            <field name="company_id"/>
                                        </group>
                                    </group>
                                </sheet>
                            </form>
                        </field>
                    </group>

                    <!-- Contact Details Section -->
                    <group>
                        <field name="contact_detail_ids" 
                               string="Contact Details"
                               readonly="selected_address_id == False"
                               widget="unlink_many2many"
                               context="{'default_parent_id': selected_address_id, 'default_company_type': 'person', 'default_type': 'contact', 'default_lead_id': id}">
                            <list editable="bottom">
                                <field name="name"/>
                                <field name="function"/>
                                <field name="phone"/>
                                <field name="email"/>
                                <field name="user_id"/>
                                <field name="street"/>
                                <field name="city"/>
                                <field name="state_id"/>
                                <field name="country_id"/>
                                <field name="company_id"/>
                            </list>
                            <form>
                                <sheet>
                                    <group>
                                        <group>
                                            <field name="name" string="Contact Name" required="True" placeholder="e.g. New Address"/>
                                            <field name="title" options="{'no_open': True}" placeholder="e.g. Mr."/>
                                            <field name="function" placeholder="e.g. Sales Director"/>
                                        </group>
                                        <group>
                                            <field name="email" widget="email"/>
                                            <field name="phone" widget="phone"/>
                                            <field name="mobile" widget="phone"/>
                                            <field name="company_id"/>
                                        </group>
                                    </group>
                                </sheet>
                            </form>
                        </field>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
</odoo>
