<odoo>
    <template id="appointment_website_filter_template" inherit_id="website_appointment.website_calendar_index_topbar">
        <xpath expr="//h4" position="after">
            <div class="d-flex flex-grow-1 justify-content-end gap-2 px-2">
				<t t-set="appointment_filters" t-value="[
                    {
                        'title': 'Type',
                        'param': 'appointment_type',
                        'options': [
                            {'value': '', 'label': 'All'},
                            {'value': 'online', 'label': 'Online'},
                            {'value': 'offline', 'label': 'Offline'}
                        ]
                    },
                    {
                        'title': 'Payment Step',
                        'param': 'payment_step',
                        'options': [
                            {'value': '', 'label': 'All'},
                            {'value': 'required', 'label': 'Required'},
                            {'value': 'not_required', 'label': 'Not Required'}
                        ]
                    },
                    {
                        'title': 'Based On',
                        'param': 'schedule_based_on',
                        'options': [
                            {'value': '', 'label': 'All'},
                            {'value': 'users', 'label': 'Users'},
                            {'value': 'resources', 'label': 'Resources'}
                        ]
                    }
                ]"/>
                <t t-foreach="appointment_filters" t-as="dropdown">
                    <div class="dropdown">
                        <button class="btn btn-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            <t t-esc="dropdown['title']"/>
                        </button>
                        <div class="dropdown-menu">
                            <t t-foreach="dropdown['options']" t-as="option">
                                <t t-set="query_params" t-value="{}"/>
                                <t t-set="dummy" t-value="query_params.update({dropdown['param']: option['value']})"/>
                                <t t-set="is_active" t-value="request.params.get(dropdown['param'], '') == option['value']"/>
                                <a t-att-href="'/appointment?' + keep_query('*', **query_params)" 
                                   t-att-class="'dropdown-item active' if is_active else 'dropdown-item'">
                                    <t t-esc="option['label']"/>
                                </a>
                            </t>
                        </div>
                    </div>
                </t>
            </div>
        </xpath>
    </template>
</odoo>
