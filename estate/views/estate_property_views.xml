<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Action for estate.property model -->
    <record id="estate_property_action" model="ir.actions.act_window">
        <field name="name">Properties</field>
        <field name="res_model">estate.property</field>
        <field name="view_mode">list,form,kanban</field>
        <field name="context">{'search_default_available': True}</field>
    </record>

    <!-- Define the List View for the "estate.property" model -->
    <record id="estate_property_list_view" model="ir.ui.view">
        <field name="name">estate.property.list</field>
        <field name="model">estate.property</field>
        <field name="arch" type="xml">
            <list string="Properties" decoration-success="state=='sold'" decoration-danger="state=='offer_received'" class="fw-bold">
                <field name="name" string="Property Name" />
                <field name="postcode" string="Postcode" />
                <field name="property_type_id" string="Property Type" />
                <field name="tag_ids" string="propert tag" widget="many2many_tags"  options="{'color_field': 'color'}"/>
                <field name="date_availability" string="Availability Date" optional="hide" />
                <field name="validity" string="validity" />
                <field name="date_deadline" string="date-deadline" />
                <field name="expected_price" string="Expected Price" />
                <field name="selling_price" string="Selling Price" />
                <field name="bedrooms" string="Bedrooms" />
                <field name="living_area" string="Living Area" />
                 <header>
                    <button name="%(action_estate_property_offer_wizard)d" string="Add Offer" type="action" class="btn-primary"/>
                </header>
            </list>
        </field>
    </record>


    <!-- Define the Form View for the "estate.property" model -->
    <record id="estate_property_form_view" model="ir.ui.view">
        <field name="name">estate.property.form</field>
        <field name="model">estate.property</field>
        <field name="arch" type="xml">
            <form string="Property Form">
                <header>
                    <button name="action_cancel_property" string="Cancel" type="object"
                        invisible="state in ['sold','cancelled']" />
                    <button name="action_set_sold" string="Sold" type="object"
                        invisible="state in ['sold','cancelled']" />
                    <field name="state" widget="statusbar"
                        statusbar_visible="new,offer_received,offer_accepted,sold" />
                </header>
                <sheet>
                    <div class="oe_title">
                        <div class="oe_edit_only">
                            <label for="name" />
                        </div>
                        <h1 class="mb32">
                            <field name="name" class="mb16" />
                        </h1>
                    </div>
                    <group>
                        <group class="mb32">
                            <!-- <field name"partner_id" class="w-50" /> -->
                            <field string="State" name="state" />
                            <field string="image" name="image" widget="image"/>
                            <field name="property_type_id" string="property_type" />
                            <field name="tag_ids" string="propert tag" widget="many2many_tags"
                                options="{'color_field': 'color'}" />
                            <field name="postcode" class="w-50" />
                            <field name="date_availability" class="w-50" />
                        </group>
                        <group>
                            <field name="expected_price" class="w-50" />
                            <field name="best_price" class="w-50" />
                            <field name="selling_price" class="w-50" />
                        </group>
                    </group>
                    <notebook>
                        <page string="More Info">
                            <group>
                                <group>
                                    <field string="Description" name="description" />
                                    <field string="Bedrooms" name="bedrooms" />
                                    <field string="Living Area (sqm)" name="living_area" />
                                    <field name="facades" />
                                    <field string="total-area" name="total_area" readonly="1" />
                                </group>
                                <group>
                                    <field string="Garage" name="garage" />
                                    <field string="Garden" name="garden" />
                                    <field string="Garden Area (sqm)" name="garden_area" />
                                    <field string="Garden Orientation" name="garden_orientation"
                                        invisible="not garden" />
                                    <field string="Visible" invisible="1" name="active" />
                                    <field name="best_price" readonly="1" />
                                </group>
                            </group>
                        </page>
                        <page string="other-info">
                            <group>
                                <field string="buyer_id" name="buyer_id"
                                    options="{'no_create':true}"></field>
                                <field string="salesperson_id" name="salesperson_id"
                                    options="{'no_create':true}"></field>
                            </group>
                        </page>
                        <page string="offer">
                            <group>
                                <field name="offer_ids" widget="one2many_list">
                                    <list decoration-danger="status=='refused'"
                                        decoration-success="status=='accepted'">
                                        <field name="price" />
                                        <field name="status" />
                                        <field name="partner_id" />
                                        <field name="validity" />
                                        <button name="action_accept_offer" type="object"
                                            string="Accept"
                                            icon="fa-check" />
                                        <button name="action_refuse_offer" type="object"
                                            string="Refuse"
                                            icon="fa-remove" />
                                        <field name="date_deadline" />
                                    </list>
                                </field>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

<!-- define the kanban view of the property type -->
    <record id="estate_properties_view_kanban" model="ir.ui.view">
        <field name="name">estate.property.kanban</field>
        <field name="model">estate.property</field>
        <field name="arch" type="xml">
        <kanban default_group_by='property_type_id' records_draggable="true">
        <templates>
        <field name="state"/>
        <t t-name="card">
            <div class="oe_kanban_global_click">
            <h3>
                <field name="name"/>
            </h3>
            <p>Expected Price:
                <field name="expected_price"/>
            </p>
            <div>
                <t t-if="record.state.raw_value=='offer_recieved'">
                <p>Best Offer:
                    <field name="best_price"/>
                </p>
                </t>
                <t t-elif="record.state.raw_value=='offer_accepted'">
                <p>Selling Price:
                    <field name="selling_price"/>
                </p>
                </t>
            </div>
            <p>Tags:
                <field name="tag_ids" widget="many2many_tags" options="{'color_field':'color'}" />
            </p>
            </div>
        </t>
        </templates>
    </kanban>
    </field>
    </record>

    <!-- Define the Search View for the "estate.property" model -->
    <record id="estate_property_search_view" model="ir.ui.view">
        <field name="name">estate.property.search</field>
        <field name="model">estate.property</field>
        <field name="arch" type="xml">
            <search string="Property Search">
                <!-- Search field for Property Name -->
                <field name="name" string="Property Name" />
                <field name="postcode" string="Postcode" />
                <field name="property_type_id" widget="selection" />
                <field name="tag_ids" />
                <field name="buyer_id" />
                <field name="salesperson_id" />
                <field name="bedrooms" string="Bedrooms" />
                <field name="selling_price" string="Selling Price" />
                <filter string="Available" name="date_availability"
                    domain="['|', ('state', '=', 'new'), ('state', '=', 'offer_recieved')]" />
                <separator />
                <filter string="Garden" name="garden" domain="[('garden', '=', 'True')]" />
                <separator />
                <filter string="Garage" name="garage" domain="[('garage',  '=', 'True')]" />
                <filter string="State" name="state" context="{'group_by':'state'}" />
                <separator />
                <filter string="Garder Orientation" name="garden_orientation"
                    context="{'group_by':'garden_orientation'}" />
                <separator />
                <filter string="Bedrooms" name="bedrooms" context="{'group_by':'bedrooms'}" />
                <field name="living_area" string="Living Area (Min)"
                    filter_domain="[('living_area', '>=', self)]" />
            </search>
        </field>
    </record>

</odoo>


    


 
   