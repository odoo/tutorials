<odoo>
    <data>
        <!-- Estate Property Kanban View -->
        <record id="estate_property_view_kanban" model="ir.ui.view">
            <field name="name">estate.property.view.kanban</field>
            <field name="model">estate.property</field>
            <field name="arch" type="xml">
                <kanban default_group_by="property_type_id" groups_draggable="1" records_draggable="1">
                        <field name="state" />
                    <templates>
                        <t t-name="card">
                            <div>
                                <h4>
                                    <field name="name" />
                                </h4>
                                <div>
                                    <span>Expected Price: <field name="expected_price" /></span>
                                </div>
                                <div t-if="record.state.raw_value == 'offer_received'">
                                    <span>Best Price: <field name="best_price" /></span>
                                </div>
                                <div t-if="record.state.raw_value == 'offer_accepted'">
                                    <span>Selling Price: <field name="selling_price" /></span>
                                </div>
                                <div>
                                    <field name="tag_ids" options="{'color_field': 'color'}" />
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!-- Estate Property List View -->
        <record id="estate_property_view_list" model="ir.ui.view">
            <field name="name">estate.property.view.list</field>
            <field name="model">estate.property</field>
            <field name="arch" type="xml">
                <list string="Channel"
                    decoration-bf="state == 'offer_accepted' or state == 'offer_received'"
                    decoration-success="state == 'offer_received'"
                    decoration-muted="state == 'sold'">

                    <!-- Always visible fields -->
                    <field name="name" />
                    <field name="postcode" />
                    <field name="expected_price" />
                    <field name="state" />
                    <field name="active" />
                    <field name="property_type_id" />
                    <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color'}" />

                    <!-- Optional fields (can be toggled in UI) -->
                    <field name="description" optional="hide" />
                    <field name="selling_price" optional="hide" />
                    <field name="bedrooms" optional="hide" />
                    <field name="living_area" optional="hide" />
                    <field name="facades" optional="hide" />
                    <field name="garage" optional="hide" />
                    <field name="garden" optional="hide" />
                    <field name="garden_area" optional="hide" />
                    <field name="garden_orientation" optional="hide" />
                </list>
            </field>
        </record>

        <!-- Estate Property Search View -->
        <record id="estate_property_view_search" model="ir.ui.view">
            <field name="name">estate.property.view.search</field>
            <field name="model">estate.property</field>
            <field name="arch" type="xml">
                <search string="Search Properties">
                    <field name="name" />
                    <field name="postcode" />
                    <field name="expected_price" />
                    <field name="bedrooms" />
                    <field name="living_area" filter_domain="[('living_area', '>=', self)]" />
                    <field name="facades" />
                    <field name="property_type_id" />
                    <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color'}" />
                    <filter string="Available" name="available_properties" domain="[('state', 'in', ['new', 'offer_received'])]" />
                    <group expand="1" string="Group By">
                        <filter name="group_by_postcode" string="Post Code"
                            context="{'group_by': 'postcode'}" />
                    </group>
                </search>
            </field>
        </record>

        <!-- Estate Property Form View -->
        <record id="estate_property_view_form" model="ir.ui.view">
            <field name="name">estate.property.view.form</field>
            <field name="model">estate.property</field>
            <field name="arch" type="xml">
                <form string="Property Form">
                    <header>
                        <button name="action_sold"
                            type="object"
                            string="Sold"
                            class="btn-primary"
                            confirm="Are you sure you want to sold this?"
                            invisible="state == 'sold' or state == 'cancelled'" />

                        <button name="action_cancel"
                            type="object"
                            string="Cancel"
                            confirm="Are you sure you want to cancel it?"
                            invisible="state == 'sold' or state == 'cancelled'" />


                        <field name="state" widget="statusbar" />
                    </header>
                    <sheet>
                        <group>
                            <h1>
                                <field name="name" placeholder="Eg. Pramukh Arcade" />
                            </h1>
                            <field name="tag_ids" widget="many2many_tags"
                                options="{'color_field': 'color'}" />
                        </group>
                        <group>
                            <group>
                                <field name="property_type_id" />
                                <field name="state" />
                                <field name="postcode" />
                                <field name="date_availability" required="False" />
                            </group>
                            <group>
                                <field name="expected_price" />
                                <field name="selling_price" />
                                <field name="best_price" />
                            </group>
                        </group>
                        <notebook>
                            <page string="Description">
                                <group>
                                    <field name="description" />
                                    <field name="bedrooms" />
                                    <field name="living_area" />
                                    <field name="facades" />
                                    <field name="garage" />
                                    <field name="garden" />
                                    <field name="garden_area" invisible='garden != True' />
                                    <field name="garden_orientation" invisible='garden != True' />
                                    <field name="active" />
                                    <field name="total" />
                                </group>
                            </page>
                            <page string="Offers">
                                <field name="offer_ids"
                                    readonly="state in ('offer_accepted', 'sold', 'cancelled')" />
                            </page>
                            <page string="Other Info">
                                <group>
                                    <field name="sales_id" />
                                    <field name="buyer_id" />
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Estate Property Inherit View -->
        <record id="view_users_form_inherit_estate" model="ir.ui.view">
            <field name="name">res.users.form.inherit.estate</field>
            <field name="model">res.users</field>
            <field name="inherit_id" ref="base.view_users_form" />
            <field name="arch" type="xml">
                <notebook position="inside">
                    <page string="Real Estate Properties">
                        <field name="property_ids">
                            <list>
                                <field name="name" />
                                <field name="postcode" />
                                <field name="expected_price" />
                                <field name="state" />
                            </list>
                        </field>
                    </page>
                </notebook>
            </field>
        </record>

        <!-- Estate Property Actions -->
        <record id="estate_property_action" model="ir.actions.act_window">
            <field name="name">Properties</field>
            <field name="res_model">estate.property</field>
            <field name="view_mode">kanban,list,form</field>
            <field name="context">{'search_default_available_properties': 1}</field>
        </record>
    </data>
</odoo>
