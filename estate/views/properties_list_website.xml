<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <template id="properties_list_website" name="Property Listing">
        <t t-call="website.layout">
            <div class="container py-5">
                <h2 class="text-start mb-4">Estate Properties</h2>
                <form method="GET" action="/properties" class="d-flex gap-2 w-50 mb-3">
                    <input type="date" id="filter_date" name="filter_date" class="form-control"/>
                    <input type="text" id="property_search" name="property_search" placeholder="Search property..." class="form-control" />
                    <button type="submit" class="btn btn-primary w-50">Search</button>
                </form>
                <div class="row">
                    <t t-foreach="properties" t-as="property">
                        <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                            <a t-att-href="'/property/' + str(property.id)" class="text-decoration-none">
                                <div class="card border-0 border-0 shadow-lg">
                                    <div class="ratio ratio-4x3">
                                        <img t-att-src="'/web/image/estate.property/' + str(property.id) + '/property_image'"
                                             class="card-img-top img-fluid rounded-top object-fit-cover"
                                             alt="Property Image" />
                                    </div>
                                    <div class="card-body">
                                        <h5 class="card-title text-primary fw-bold" t-field="property.name"></h5>
                                        <p class="card-text text-muted small" t-field="property.description"></p>
                                        <p class="card-text mb-1">
                                            <strong>Price:</strong> 
                                            <span t-field="property.expected_price" class="fw-bold"></span> INR
                                        </p>
                                        <p class="card-text mt-0">
                                            <strong>Status:</strong> 
                                            <span t-field="property.state"></span>
                                        </p>
                                        <p class="card-text">
                                            <t t-foreach="property.tag_ids" t-as="tag">
                                                <span class="badge bg-primary me-1" t-field="tag.name"></span>
                                            </t>
                                        </p>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </t>
                    
                    <t t-if="not properties">
                        <div class="text-center mt-5">
                            <h4 class="text-muted mt-3">No properties found</h4>
                            <p class="text-muted">Try adjusting your filters or check back later.</p>
                            <a href="/properties" class="btn btn-primary mt-2">
                                Browse All Properties
                            </a>
                        </div>
                    </t>
                </div>

                <t t-if="properties" >
                    <div class="d-flex justify-content-center mt-2 mb-3">
                        <t t-call="website.pager" />
                    </div>                    
                </t>
            </div>
        </t>
    </template>

    <template id="property_details_website" name="Property Details">
        <t t-call="website.layout">
            <div class="container py-5">
                <div class="row align-items-center">
                    <div class="col-lg-6">
                        <div class="card border-0 shadow-lg">
                            <div class="ratio ratio-4x3">
                                <img t-att-src="'/web/image/estate.property/' + str(property.id) + '/property_image'"
                                     class="card-img-top img-fluid rounded object-fit-cover"
                                     alt="Property Image" />
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <h2 class="text-primary fw-bold mt-1" t-field="property.name"></h2>
                        <p class="text-muted mb-0" t-field="property.description"></p>
                        <t t-if="property.tag_ids">
                            <p>
                                <t t-foreach="property.tag_ids" t-as="tag">
                                    <span class="badge bg-info mt-1" t-field="tag.name"></span>
                                </t>
                            </p>
                        </t>
                        <t t-else="">
                            <p class="text-muted">No Tags</p>
                        </t>

                        <div class="mt-3">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item">
                                    <strong>Property type:</strong> 
                                    <span t-field="property.property_type_id.name"></span>
                                </li>
                                <li class="list-group-item">
                                    <strong>Price:</strong> 
                                    <span class="fw-bold" t-field="property.expected_price"></span> INR
                                </li>
                                <li class="list-group-item">
                                    <strong>Status:</strong> 
                                    <span t-field="property.state" class="badge bg-primary"></span>
                                </li>
                                <li class="list-group-item">
                                    <strong>Available from:</strong> 
                                    <span t-field="property.date_availability"></span>
                                </li>
                                <li class="list-group-item">
                                    <strong>Bedrooms:</strong> 
                                    <span t-field="property.bedrooms"></span>
                                </li>
                                <li class="list-group-item">
                                    <strong>Postcode:</strong> 
                                    <t t-if="property.postcode">
                                        <span t-field="property.postcode" />
                                    </t>
                                </li>
                            </ul>
                        </div>

                        <!-- Back Button -->
                        <div class="mt-4">
                            <a href="/properties" class="btn btn-outline-secondary">
                                <i class="fa fa-arrow-left"></i> Back to Listings
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

</odoo>
