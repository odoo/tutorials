<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <template id="property_offer_table_sub">
    <t t-if="len(property.offer_ids) > 0">
      <p>
        <strong>Expected Price:</strong>
        <span t-field="property.expected_price" />
      </p>
      <p>
        <strong>Status:</strong>
        <span t-field="property.state" />
      </p>
      <table class="table table-sm mt32" style="width:100%;">
        <thead>
          <tr>
            <th>Price</th>
            <th>Partner</th>
            <th>Validity (days)</th>
            <th>Deadline</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr t-foreach="property.offer_ids" t-as="offer">
            <td>
              <span t-field="offer.price" />
            </td>
            <td>
              <span t-field="offer.partner_id.name" />
            </td>
            <td>
              <span t-field="offer.validity" />
            </td>
            <td>
              <span t-field="offer.date_deadline" />
            </td>
            <td>
              <span t-field="offer.status" />
            </td>
          </tr>
        </tbody>
      </table>
    </t>
    <t t-else="">
      <p>
        <em>No offers available for this property.</em>
      </p>
    </t>
  </template>
  <template id="report_property_offers">
    <t t-foreach="docs" t-as="property">
      <t t-call="web.html_container">
        <t t-call="web.external_layout">
          <div class="page">
            <h2>
              <span t-field="property.name" />
            </h2>
            <p>
              <strong>Salesman:</strong>
              <span t-field="property.seller.name" />
            </p>
            <t t-if="property.offer_ids">
              <t t-set="doc" t-value="doc" />
              <t t-call="real_estate.property_offer_table_sub" />
            </t>
            <t t-else="">
              <p>
                <strong>No offers have been made yet </strong>
              </p>
            </t>
          </div>
        </t>
      </t>
    </t>
  </template>
  <template id="report_property_user_offers">
    <t t-foreach="docs" t-as="salesman">
      <t t-call="web.html_container">
        <t t-call="web.external_layout">
          <div class="page">
            <h2>
              <strong>Salesman: </strong>
              <span t-field="salesman.name" />
            </h2>
            <t t-if="salesman.property_ids">
              <t t-set="properties" t-value="salesman.property_ids" />
              <t t-foreach="properties" t-as="property">
                <h3>
                  <span t-field="property.name" />
                </h3>
                <t t-call="real_estate.property_offer_table_sub" />
              </t>
            </t>
            <strong t-else="">No properties found :</strong>
          </div>
        </t>
      </t>
    </t>
  </template>
  <template id="inherit_property_offer_table_sub" inherit_id="real_estate.report_property_offers">
    <xpath expr="//div[hasclass('page')]" position="inside">
      <t t-if="property.state == 'sold'">
        <p>!!! Invoice has already been created !!!</p>
      </t>
    </xpath>
  </template>
</odoo>
