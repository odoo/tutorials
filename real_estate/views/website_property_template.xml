<odoo>
    <record id="website_property_listing_menu" model="website.menu">
        <field name="name">Properties</field>
        <field name="url">/properties</field>
        <field name="parent_id" ref="website.main_menu"/>
    </record>
    <template id="website_property_template" name="Property Listing">
        <t t-call="website.layout">
            <div class="container">
<h1 class="text-center my-4 fw-bold text-primary" style="font-size: 2.5rem; text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);">
    üè° From City Chic to Suburban Bliss ‚Äî Find Your Place
</h1>
                <div class="row">
                    <t t-foreach="properties" t-as="property">
                        <div class="col-md-4 ">
                            <div class="card shadow-sm mb-4">
                                <div class="card-body " >
                                    <h3><a t-att-href="'/properties/%s' % property.id" t-esc="property.name"/></h3>
                                    <p class="card-text"><t t-esc="property.description"/></p>
                                    <p><strong>Price: </strong> Rs. <t t-esc="property.expected_price"/> </p>
                                    <img 
                                        t-if="property['image']" 
                                        class="card-img-top" 
                                        t-att-src="image_data_uri(property['image'])" 
                                        t-att-alt="property.name"
                                        style="width: 100%; height: 200px; object-fit: fill;"
                                    />
                                    <img 
                                        t-else="" 
                                        class="card-img-top" 
                                        src="/real_estate/static/src/images/card-default.svg" 
                                        t-att-alt="property.name" 
                                        style="width: 180px; height: 180px; object-fit: cover;"
                                    />
                                    <div class="text-center mt-3">
                                        <a t-att-href="'/properties/%s' % property.id" class="btn btn-primary btn-md">Know More</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </div>
                <div class="row mt-4 mb-3">
                    <div class="col-12 d-flex justify-content-center">
                        <t t-call="website.pager" t-set="pager" t-options="pager"/>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="property_detail_template" name="Property Detail">
        <t t-call="website.layout">
            <div class="container my-5 p-4 shadow-lg rounded bg-light">
                <div class="row">
                    <div class="col-md-6 text-center">
                        <img 
                            t-if="property['image']" 
                            class="img-fluid rounded border" 
                            t-att-src="image_data_uri(property['image'])" 
                            t-att-alt="property.name"
                            style="width: 100%; height: auto; object-fit: cover;"
                        />
                        <img 
                            t-else="" 
                            class="img-fluid rounded border" 
                            src="/real_estate/static/src/images/card-default.svg" 
                            t-att-alt="property.name" 
                            style="max-width: 100%; height: auto; object-fit: cover;"
                        />
                    </div>
                     <div class="col-md-6">
                        <h1 class="mb-3 text-primary"><t t-esc="property.name"/></h1>
                        <p class="lead"><t t-esc="property.description"/></p>
                        <div class="mt-3">
                            <span t-if="property.property_tag_ids" class="badge bg-orange " 
                                t-foreach="property.property_tag_ids" t-as="tag" t-esc="tag.name"  />
                        </div>
                        <hr class="my-2"/>
                        <ul class="list-unstyled">
                            <li><strong>Price:</strong> ‚Çπ <span class="text-success" t-esc="property.expected_price"/> </li>
                            <li><strong>Property Type:</strong> <span t-esc="property.property_type_id.name"/></li>
                            <li><strong>Bedrooms:</strong> <span t-esc="property.bedrooms"/></li>
                            <li><strong>Living Area:</strong> <span t-esc="property.living_area"/> sqm</li>
                            <li><strong>Facades:</strong> <span t-esc="property.facades"/></li>
                            <li><strong>Garage:</strong> <span t-esc="'Yes' if property.garage else 'No'"/></li>
                            <li><strong>Garden:</strong> <span t-esc="'Yes' if property.garden else 'No'"/></li>
                            <li t-if="property.garden"><strong>Garden Area:</strong> <span t-esc="property.garden_area"/> sqm</li>
                            <li t-if="property.garden"><strong>Garden Orientation:</strong> <span t-esc="property.garden_orientation"/></li>
                            <li><strong>Postcode:</strong> <span t-esc="property.postcode"/></li>
                            <li><strong>Available From:</strong> <span t-esc="property.date_availability"/></li>
                            <li><strong>Salesperson:</strong> <span t-esc="property.salesperson_id.name"/></li>
                            <li t-if="property.buyer_id"><strong>Buyer:</strong> <span t-esc="property.buyer_id.name"/></li>
                        </ul>
                    </div>

                    <div class="offers mt-4 p-4 border rounded bg-light" style="width:100%;">
                    <h4 class="fw-bold mb-4 text-center" style="font-size: 30px">Offers</h4>
                    <t t-if="property.offer_ids">
                        <table class="table table-striped text-center">
                            <thead class="table-dark">
                                <tr>
                                    <th style="width: 10%;">Sr.No.</th>
                                    <th style="width: 30%;">Offer Price (‚Çπ)</th>
                                    <th style="width: 30%;">Offered by</th>
                                    <th style="width: 20%;">Date Deadline</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="counter" t-value="1"/>
                                <t t-foreach="property.offer_ids" t-as="offer">
                                    <tr>
                                        <td style="width: 10%; vertical-align: middle;"><span t-esc="counter"/></td>
                                        <td style="width: 30%; vertical-align: middle;"><span t-esc="offer.price"/></td>
                                        <td style="width: 30%; vertical-align: middle;"><span t-esc="offer.partner_id.name"/></td>
                                        <td style="width: 20%; vertical-align: middle;"><span t-esc="offer.date_deadline"/></td>
                                    </tr>
                                    <t t-set="counter" t-value="counter + 1"/>
                                </t>

                                <tr>
                                <td colspan="4" class="text-center">
                                    <input type="checkbox" class="btn-check" id="toggleOfferForm" autocomplete="off" />
                                    <label class="btn btn-outline-primary" for="toggleOfferForm" id="toggleOfferButton"> Add Your Offer</label>
                                </td>
                            </tr>
                            <form t-att-action="'/properties/%s/make-offer' % property.id" method="post">
                                <tr id="offerFormRow" style="display: none;">

                                        <td style="width: 10%;"></td>
                                        <td style="width: 40%;"><input type="number" name="offer_price" required="1" class="form-control" placeholder="Offer Price" style="text-align:center;"/></td>
                                        <td style="width: 40%;"><input type="date" name="date_validity" required="1" class="form-control" placeholder="Date Deadline" style="text-align:center;"/></td>
                                        <td style="width: 10%;"></td>

                                </tr>
                                <tr id="submitRow" style="display: none;">
                                    <td colspan="4" class="text-center"><button type="submit" class="btn btn-primary">Submit Offer</button></td>
                                </tr>
                            </form>
                            </tbody>
                        </table>
                    </t>
                    <t t-else="">
                        <p class="text-center text-muted">No offers available.</p>
                        <table class="table table-striped text-center">
                            <tr>
                                <td colspan="4" class="text-center">
                                    <input type="checkbox" class="btn-check" id="toggleOfferForm" autocomplete="off" />
                                    <label class="btn btn-outline-primary" for="toggleOfferForm" id="toggleOfferButton"> Add Your Offer</label>
                                </td>
                            </tr>
                            <form t-att-action="'/properties/%s/make-offer' % property.id" method="post">
                                <tr id="offerFormRow" style="display: none;">

                                        <td style="width: 10%;"></td>
                                        <td style="width: 40%;"><input type="number" name="offer_price" required="1" class="form-control" placeholder="Offer Price" style="text-align:center;"/></td>
                                        <td style="width: 40%;"><input type="date" name="date_validity" required="1" class="form-control" placeholder="Date Deadline" style="text-align:center;"/></td>
                                        <td style="width: 10%;"></td>

                                </tr>
                                <tr id="submitRow" style="display: none;">
                                    <td colspan="4" class="text-center"><button type="submit" class="btn btn-primary">Submit Offer</button></td>
                                </tr>
                            </form>
                        </table>
                    </t>
                </div>
                </div>
            </div>
        </t>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                let toggleCheckbox = document.getElementById("toggleOfferForm");
                let offerFormRow = document.getElementById("offerFormRow");
                let submitRow = document.getElementById("submitRow");
                const buttonLabel = document.getElementById("toggleOfferButton");

                if (toggleCheckbox) {
                    toggleCheckbox.addEventListener("change", function () {
                        if (this.checked) {
                            // Show form rows
                            offerFormRow.style.display = "table-row";
                            submitRow.style.display = "table-row";
                            // Change button to Cancel style
                            buttonLabel.innerHTML = "Cancel";
                            buttonLabel.classList.remove("btn-outline-primary");
                            buttonLabel.classList.add("btn-outline-danger");
                        } else {
                            // Hide form rows
                            offerFormRow.style.display = "none";
                            submitRow.style.display = "none";
                            // Revert button to Add New Offer style
                            buttonLabel.innerHTML = "Add Your Offer";
                            buttonLabel.classList.remove("btn-outline-danger");
                            buttonLabel.classList.add("btn-outline-primary");
                        }
                    });
                }
            });

            
        </script>
    </template>
</odoo>
