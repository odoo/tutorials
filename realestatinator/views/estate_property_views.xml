<?xml version="1.0"?>
<odoo>
	<record id="estate_property_model_action" model="ir.actions.act_window">
		<field name="name">Estate Property Model Action</field>
		<field name="res_model">estate_property</field>
		<field name="view_mode">kanban,list,form</field>
		<field name="context">{'search_default_available': True}</field>
	</record>
	<record id="estate_property_view_kanban" model="ir.ui.view">
		<field name='name'>estate.property.view.kanban</field>
		<field name='model'>estate_property</field>
		<field name="arch" type="xml">
			<kanban string='Properties' default_group_by='state' group_edit="True" groups_draggable="True" records_draggable="False" default_order="sequence">
				<templates>
					<t t-name="card">
						<div>
							<h1><field name='name' /></h1>
							<label for='expected_price'>Expected Price : </label>
							<field name='expected_price' />
							<br/>
							<t t-if="record.state.raw_value == 'offer_received'">
								<label for='best_price'>Best Offer : </label>
								<field name='best_price'/>
								<field name='state' invisible="1"/>
								<br/>
							</t>
							<t name='selling_price' t-if='record.state.raw_value == "offer_accepted" or record.state.raw_value == "sold"'>
								<label for='selling_price'>Selling Price : </label>
								<field name='selling_price'/>
								<field name='state' invisible="1"/>
								<br/>
							</t>
						</div>
					</t>
				</templates>
			</kanban>
		</field>
	</record>
	<record id="estate_property_model_list" model="ir.ui.view">
		<field name="name">estate_property_list</field>
		<field name="model">estate_property</field>
		<field name="arch" type="xml">
			<list string='Properties' 
				decoration-success="state == 'offer_received' or state == 'offer_accepted'" 
				decoration-bf="state == 'offer_accepted'"
				decoration-muted="state == 'sold' or state == 'cancelled'"
			>
				<field name='name'/>
				<field name='property_type_id' options="{'no_create': true}"/>
				<field name='state' optional="1"/>
				<field name='tag_ids' widget="many2many_tags" options="{'color_field': 'color'}"/>
				<field name='postcode'/>
				<field name='bedrooms' optional="1"/>
				<field name='living_area' optional="1"/>
				<field name='expected_price' optional="1"/>
				<field name='selling_price' optional="1"/>
				<field name='date_availability' optional="1"/>
			</list>
		</field>
	</record>
	<record id="res_users_view_simple_form" model="ir.ui.view">
		<field name="name">res.users.view.simple.form.inherit</field>
		<field name="model">res.users</field>
		<field name="inherit_id" ref="base.view_users_simple_form"/>
		<field name="arch" type="xml">
			<xpath expr="//form//sheet//group[@name='phone_numbers']" position="after">
				<notebook>
					<page name='properties' string='properties'>
						<field name='property_ids'>
							<list string='Properties' 
								decoration-success="state == 'offer_received' or state == 'offer_accepted'" 
								decoration-bf="state == 'offer_accepted'"
								decoration-muted="state == 'sold' or state == 'cancelled'"
							>
								<field name='name'/>
								<field name='property_type_id' options="{'no_create': true}"/>
								<field name='state' optional="1"/>
								<field name='tag_ids' widget="many2many_tags" options="{'color_field': 'color'}"/>
								<field name='postcode'/>
								<field name='bedrooms' optional="1"/>
								<field name='living_area' optional="1"/>
								<field name='expected_price' optional="1"/>
								<field name='selling_price' optional="1"/>
								<field name='date_availability' optional="1"/>
							</list>
						</field>
					</page>
				</notebook>
			</xpath>
		</field>
	</record>
	<record id="res_users_view_form" model="ir.ui.view">
		<field name="name">res.users.view.form.inherit</field>
		<field name="model">res.users</field>
		<field name="inherit_id" ref="base.view_users_form"/>
		<field name="arch" type="xml">
			<xpath expr="//form//sheet//notebook//page[@name='account_security']" position="after">
				<page name='properties' string='properties'>
					<field name='property_ids'>
						<list string='Properties' 
							decoration-success="state == 'offer_received' or state == 'offer_accepted'" 
							decoration-bf="state == 'offer_accepted'"
							decoration-muted="state == 'sold' or state == 'cancelled'"
						>
							<field name='name'/>
							<field name='property_type_id' options="{'no_create': true}"/>
							<field name='state' optional="1"/>
							<field name='tag_ids' widget="many2many_tags" options="{'color_field': 'color'}"/>
							<field name='postcode'/>
							<field name='bedrooms' optional="1"/>
							<field name='living_area' optional="1"/>
							<field name='expected_price' optional="1"/>
							<field name='selling_price' optional="1"/>
							<field name='date_availability' optional="1"/>
						</list>
					</field>
				</page>
			</xpath>
		</field>
	</record>
	<record id='estate_property_model_form' model='ir.ui.view'>
		<field name="name">estate_property_list</field>
		<field name="model">estate_property</field>
		<field name="arch" type="xml">
			<form>
				<header>
					<button name='mark_sold' type='object' string='Sell' invisible="state != 'offer_accepted'"/>
					<button name='mark_cancelled' type='object' string='Cancel' invisible="state == 'sold' or state == 'cancelled'"/>
					<field name='state' widget='statusbar' statusbar_visible='new, offer_received, offer_accepted, sold'/>
				</header>
				<h1><field name='name'/></h1>
				<field name='tag_ids' widget="many2many_tags" options="{'color_field': 'color'}"/>
				<group>
					<group>
						<field name='postcode'/>
						<field name='date_availability'/>
					</group>
					<group>
						<field name='expected_price'/>
						<field name='selling_price'/>
						<field name='best_price'/>
					</group>
					
				</group>
				<notebook>
					<page string='Description'>
						<group>
							<field name='description'/>
							<field name='property_type_id' options="{'no_create': true}"/>
							<field name='bedrooms'/>
							<field name='living_area'/>
							<field name='facades'/>
							<field name='garden'/>
							<field name='garage'/>
							<field name='garden_area' invisible="not garden"/>
							<field name='garden_orientation' invisible="not garden"/>
							<field name='total_area'/>
						</group>
					</page>
					<page string='Offers'>
						<field name='offer_ids' readonly="state == 'offer_accepted' or state == 'sold' or state == 'cancelled'"/>
					</page>
					<page string='Other'>
						<group>
							<field name='buyer'/>
							<field name='sales_person'/>
							<field name='state'/>
							<field name='active'/>
						</group>
					</page>
				</notebook>
			</form>
		</field>
	</record>
	<record id="estate_property_model_search" model="ir.ui.view">
		<field name="name">estate_property_list</field>
		<field name="model">estate_property</field>
		<field name="arch" type="xml">
			<search string='Search Properties'>
				<field name='name'/>
				<field name='postcode'/>
				<field name='bedrooms'/>
				<field name='living_area'/>
				<field name='expected_price'/>
				<field name='facades'/>
				<field name='tag_ids'/>
				<field name="living_area" filter_domain="[('living_area', '>=', self)]"/>
				<separator/>
				<filter string="Include archived" name="archived" domain="['|', ('active', '=', True), ('active', '=', False)]"/>
				<filter string="Available Properties" name="available" domain="['|', ('state', '=', 'new'), ('state', '=', 'offer_received')]"/>
				<separator/>
				<filter string='State' name='state' context="{'group_by':'state', 'residual_visible':True}"/>
				<filter string='Postcode' name='postcode' context="{'group_by':'postcode', 'residual_visible':True}"/>
				<filter string='Property Type' name='property_type_id' context="{'group_by':'property_type_id', 'residual_visible':True}"/>
			</search>
		</field>
	</record>
</odoo>
