<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="listing_page_inherit_auction" inherit_id="estate.listing_page" name="Estate Property Listing - Auction">
        <xpath expr="//div[@class='row']//div[3]" position="after">
            <div class="col-md-3">
                <label class="form-label">Property Sale Formate</label>
                <select name="property_sale_format" class="form-control">
                    <option value="all" t-att-selected="request.params.get('property_sale_format') == 'all'">All</option>
                    <option value="auction" t-att-selected="request.params.get('property_sale_format') == 'auction'">Auction</option>
                    <option value="regular" t-att-selected="request.params.get('property_sale_format') == 'regular'">Regular</option>
                </select>
            </div>
        </xpath>
    </template>
    <!-- Inherited Estate Property Detail Page -->
    <template id="property_detail_page_inherit" inherit_id="estate.property_detail_page" name="Estate Property Description - Auction Button">
        <xpath expr="//div[1]/div[2]" position="inside">
            <t t-if="property.property_sale_format == 'auction' and property.auction_stage in ['02_auction', '03_sold']">
                <div class="alert alert-info col-md-12">
                    <strong>Auction Ends In:</strong>
                    <div t-att-data-auction_end_time="property.auction_end_time" class="js_auction_timer"></div>
                </div>
            </t>
            <t t-if="property.property_sale_format == 'auction' and property.auction_stage == '02_auction'">
                <div class="col-md-6">
                    <a t-att-href="'/property/auction/%d' % property.id" class="btn btn-warning">
                        <i class="fa fa-gavel"></i> Participate in Auction
                    </a>
                </div>
            </t>
        </xpath>
    </template>

    <template id="create_bid" name="Create Bid Form">
        <t t-call="website.layout">
            <div class="d-flex justify-content-center">
                <div class="">
                    <h2>Add offer for <t t-esc="property.name"/></h2>
                    <form action="/property/auction/bid" method="post" enctype="multipart/form-data" class="mt-4">
                        <div class="row justify-content-center">
                            <input type="hidden" name="property_id" t-att-value="property.id"/>
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <div class="col-lg-12">
                                <div class="mb-3 row align-items-center">
                                    <label for="pdf_file" class="col-sm-3 col-form-label text-end">Name:</label>
                                    <div class="col-sm-9">
                                        <input type="text" id="name" name="name" t-att-value="request.env.user.name" readonly="true" class="form-control"/>
                                    </div>
                                </div>
                                <div class="mb-3 row align-items-center">
                                    <label for="pdf_file" class="col-sm-3 col-form-label text-end">Bid Amount:</label>
                                    <div class="col-sm-9">
                                        <input type="number" id="bid_amount" name="bid_amount" required="true" class="form-control"/>
                                    </div>
                                </div>
                                <div class="text-center">
                                    <button type="submit" class="btn btn-primary">Submit</button>
                                    <a t-att-href="'/property/%d' % property.id" class="btn btn-primary">Cancel</a>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </t>
    </template>

    <template id="generic_message" name="Generic Message">
        <t t-call="website.layout">
            <div class="d-flex justify-content-center">
                <div class="text-center">
                    <h3 t-esc="title"></h3>
                    <p t-esc="message"></p>
                </div>
            </div>
            <div class="text-center mt-4">
                    <a href="/property" class="btn btn-primary">
                       Back to Property List
                    </a>
            </div>
        </t>
    </template>
    <template id="generic_error" name="Generic Error">
        <t t-call="website.layout">
            <div class="d-flex justify-content-center">
                <div class="text-center">
                    <h3 class="text-danger">Oops!</h3>
                    <p t-esc="error"></p>
                    <t t-if="expected_price">
                        <p>Expected price is: <t t-esc="expected_price"/></p>
                    </t>
                </div>
            </div>
            <div class="text-center mt-4">
                    <a t-att-href="'/property/auction/%s' %id" class="btn btn-primary">
                        Back to bid form
                    </a>
                    <a href="/property" class="btn btn-primary">
                        Back to Property List
                    </a>
            </div>
        </t>
    </template>
</odoo>
