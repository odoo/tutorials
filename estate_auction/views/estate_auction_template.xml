<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="property_listing_template_inherit" inherit_id="estate.property_listing_template">
        <xpath expr="//div[contains(@class, 'property-item')]" position="attributes">
            <attribute name="t-att-data-auction">'true' if property.auction_stage == 'auction' else
                'false'</attribute>
            <attribute name="t-att-data-price">property.expected_price</attribute>
        </xpath>
        <xpath expr="//button[@id='filter-btn']" position="after">
            <div class="filter">
                <button class="btn btn-outline-dark px-4 rounded-pill" id="auction-filter-btn">
                    <i class="fa fa-gavel me-2"></i> Auction </button>
                <div id="price-filter-panel margin-top: 10px;" style="display: contents;">
                    <input type="number" id="min-price" placeholder="Min Price" class="form-control"
                        style="display: inline-block; width: 20%;margin-left: 2%;" />
                    <input type="number" id="max-price" placeholder="Max Price" class="form-control"
                        style="display: inline-block; width: 20%;margin-left: 2%;" />
                    <button class="btn btn-outline-dark px-4 rounded-pill" id="apply-price-filter-btn"
                        style="margin-left: 2%;">
                        <i class="fa fa-filter me-2"></i> Apply </button>
                </div>
            </div>
        </xpath>

        <xpath expr="//script" position="before">
            <script>
                document.addEventListener("DOMContentLoaded", function () {
                    const auctionFilterBtn = document.getElementById("auction-filter-btn");
                    const minPriceInput = document.getElementById("min-price");
                    const maxPriceInput = document.getElementById("max-price");
                    const applyPriceBtn = document.getElementById("apply-price-filter-btn");
                    const propertyItems = document.querySelectorAll(".property-item");

                    let auctionActive = false;
                    let minPrice = 0;
                    let maxPrice = Infinity;

                    function applyFilters() {
                        let minPriceValue = minPriceInput.value.trim();
                        let maxPriceValue = maxPriceInput.value.trim();

                        minPrice = minPriceValue !== "" ? parseFloat(minPriceValue) : 0;
                        maxPrice = maxPriceValue !== "" ? parseFloat(maxPriceValue) : Infinity;

                        propertyItems.forEach(item =&gt; {
                            // Retrieve attributes from elements
                            const isAuction = item.getAttribute("data-auction") === "true";
                            const priceAttr = item.getAttribute("data-price");
                            const price = priceAttr ? parseFloat(priceAttr) : 0; // Ensure it's a valid number

                            let showItem = true;
                            if (auctionActive &amp;&amp; !isAuction) {
                                showItem = false;
                            }

                            if (price &lt; minPrice || price &gt; maxPrice) {
                                showItem = false;
                            }
                            item.style.display = showItem ? "block" : "none";
                        });
                    }
                    auctionFilterBtn.addEventListener("click", function () {
                        auctionActive = !auctionActive; // toggle
                        auctionFilterBtn.classList.toggle("active", auctionActive);
                        auctionFilterBtn.style.backgroundColor = auctionActive ? "#875A7B" : "";
                        auctionFilterBtn.style.color = auctionActive ? "white" : "";

                        applyFilters(); // Apply filters immediately
                    });
                    applyPriceBtn.addEventListener("click", applyFilters);
                });

            </script>

            <style>
            #auction-filter-btn:hover,
            #auction-filter-btn.active {
                background-color: #875A7B !important;
                color: white !important;
                border-color: #875A7B !important;
            }

            #price-filter-btn:hover,
            #price-filter-btn.active {
                background-color: #875A7B !important;
                color: white !important;
                border-color: #875A7B !important;
            }
            #apply-price-filter-btn:hover,
            #apply-price-filter-btn.active {
                background-color: #875A7B !important;
                color: white !important;
                border-color: #875A7B !important;
            }

            #apply-price-filter-btn:hover,
            #apply-price-filter-btn.active {
                background-color: #875A7B !important;
                color: white !important;
                border-color: #875A7B !important;
            }
            .filter{
                display: flex;
                align-items: center;
                width: 50%;
            }
            .price-filter-panel{
                display: contents;
            }


            </style>
        </xpath>

    </template>
</odoo>